import{r as a,R as A,s as B}from"./radix-ui-nV3zCg5Q.js";function F(e,t){if(e instanceof RegExp)return{keys:!1,pattern:e};var n,s,r,o,c=[],f="",l=e.split("/");for(l[0]||l.shift();r=l.shift();)n=r[0],n==="*"?(c.push(n),f+=r[1]==="?"?"(?:/(.*))?":"/(.*)"):n===":"?(s=r.indexOf("?",1),o=r.indexOf(".",1),c.push(r.substring(1,~s?s:~o?o:r.length)),f+=~s&&!~o?"(?:/([^/]+?))?":"/([^/]+?)",~o&&(f+=(~s?"?":"")+"\\"+r.substring(o))):f+="/"+r;return{keys:c,pattern:new RegExp("^"+f+(t?"(?=$|/)":"/?$"),"i")}}const H=A.useInsertionEffect,M=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",L=M?a.useLayoutEffect:a.useEffect,N=H||L,y=e=>{const t=a.useRef([e,(...n)=>t[0](...n)]).current;return N(()=>{t[0]=e}),t[1]},T="popstate",E="pushState",g="replaceState",V="hashchange",R=[T,E,g,V],q=e=>{for(const t of R)addEventListener(t,e);return()=>{for(const t of R)removeEventListener(t,e)}},S=(e,t)=>B.useSyncExternalStore(q,e,t),z=()=>location.search,G=({ssrSearch:e=""}={})=>S(z,()=>e),b=()=>location.pathname,J=({ssrPath:e}={})=>S(b,e?()=>e:b),Q=(e,{replace:t=!1,state:n=null}={})=>history[t?g:E](n,"",e),W=(e={})=>[J(e),Q],w=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[w]>"u"){for(const e of[E,g]){const t=history[e];history[e]=function(){const n=t.apply(this,arguments),s=new Event(e);return s.arguments=arguments,dispatchEvent(s),n}}Object.defineProperty(window,w,{value:!0})}const X=(e,t)=>t.toLowerCase().indexOf(e.toLowerCase())?"~"+t:t.slice(e.length)||"/",O=(e="")=>e==="/"?"":e,Y=(e,t)=>e[0]==="~"?e.slice(1):O(t)+e,Z=(e="",t)=>X(k(O(e)),k(t)),k=e=>{try{return decodeURI(e)}catch{return e}},j={hook:W,searchHook:G,parser:F,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:e=>e},_=a.createContext(j),m=()=>a.useContext(_),I={},K=a.createContext(I),ee=()=>a.useContext(K),p=e=>{const[t,n]=e.hook(e);return[Z(e.base,t),y((s,r)=>n(Y(s,e.base),r))]},re=()=>p(m()),D=(e,t,n,s)=>{const{pattern:r,keys:o}=t instanceof RegExp?{keys:!1,pattern:t}:e(t||"*",s),c=r.exec(n)||[],[f,...l]=c;return f!==void 0?[!0,(()=>{const i=o!==!1?Object.fromEntries(o.map((d,v)=>[d,l[v]])):c.groups;let u={...l};return i&&Object.assign(u,i),u})(),...s?[f]:[]]:[!1,null]},te=({children:e,...t})=>{const n=m(),s=t.hook?j:n;let r=s;const[o,c]=t.ssrPath?.split("?")??[];c&&(t.ssrSearch=c,t.ssrPath=o),t.hrefs=t.hrefs??t.hook?.hrefs;let f=a.useRef({}),l=f.current,i=l;for(let u in s){const d=u==="base"?s[u]+(t[u]||""):t[u]||s[u];l===i&&d!==i[u]&&(f.current=i={...i}),i[u]=d,(d!==s[u]||d!==r[u])&&(r=i)}return a.createElement(_.Provider,{value:r,children:e})},C=({children:e,component:t},n)=>t?a.createElement(t,{params:n}):typeof e=="function"?e(n):e,ne=e=>{let t=a.useRef(I);const n=t.current;return t.current=Object.keys(e).length!==Object.keys(n).length||Object.entries(e).some(([s,r])=>r!==n[s])?e:n},oe=({path:e,nest:t,match:n,...s})=>{const r=m(),[o]=p(r),[c,f,l]=n??D(r.parser,e,o,t),i=ne({...ee(),...f});if(!c)return null;const u=l?a.createElement(te,{base:l},C(s,i)):C(s,i);return a.createElement(K.Provider,{value:i,children:u})},ce=a.forwardRef((e,t)=>{const n=m(),[s,r]=p(n),{to:o="",href:c=o,onClick:f,asChild:l,children:i,className:u,replace:d,state:v,...$}=e,x=y(h=>{h.ctrlKey||h.metaKey||h.altKey||h.shiftKey||h.button!==0||(f?.(h),h.defaultPrevented||(h.preventDefault(),r(c,e)))}),P=n.hrefs(c[0]==="~"?c.slice(1):n.base+c,n);return l&&a.isValidElement(i)?a.cloneElement(i,{onClick:x,href:P}):a.createElement("a",{...$,onClick:x,href:P,className:u?.call?u(s===c):u,children:i,ref:t})}),U=e=>Array.isArray(e)?e.flatMap(t=>U(t&&t.type===a.Fragment?t.props.children:t)):[e],ae=({children:e,location:t})=>{const n=m(),[s]=p(n);for(const r of U(e)){let o=0;if(a.isValidElement(r)&&(o=D(n.parser,r.props.path,t||s,r.props.nest))[0])return a.cloneElement(r,{match:o})}return null},ue=e=>{const{to:t,href:n=t}=e,s=m(),[,r]=p(s),o=y(()=>r(t||n,e)),{ssrContext:c}=s;return L(()=>{o()},[]),c&&(c.redirectTo=t),null};export{ce as L,oe as R,ae as S,ue as a,re as u};
